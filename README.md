# Excel转JSON工具

这是一个Python脚本，用于将包含中文拼音数据的Excel文件转换为JSON格式。

## 功能特点

- 支持.xlsx和.xls格式的Excel文件
- 自动识别列名：单字拼音、汉字、词、词拼音
- 数据清理和验证
- 生成格式化的JSON文件
- 支持命令行参数和交互式输入
- 提供数据预览和统计信息

## 安装依赖

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install pandas openpyxl xlrd
```

## 使用方法

### 方法1：命令行参数

```bash
python3 转excel为json的脚本.py 你的文件.xlsx
```

### 方法2：交互式输入

```bash
python3 转excel为json的脚本.py
```

然后按提示输入Excel文件路径。

## 输入文件格式

Excel文件应包含以下四列：

| 单字拼音 | 汉字 | 词 | 词拼音 |
|----------|------|----|--------|
| á        | 啊   | 啊呀 | á yā |
| à        | 啊   | 啊哈 | à hā |
| ǎ        | 啊   | 啊唷 | ǎ yō |
| ā        | 啊   | 啊呀 | ā ya |
| ái       | 挨   | 挨饿 | ái è |

## 输出格式

脚本会生成一个JSON文件，包含转换后的数据：

```json
[
  {
    "单字拼音": "á",
    "汉字": "啊",
    "词": "啊呀",
    "词拼音": "á yā"
  },
  {
    "单字拼音": "à",
    "汉字": "啊",
    "词": "啊哈",
    "词拼音": "à hā"
  }
]
```

## 注意事项

- 确保Excel文件包含正确的列名
- 脚本会自动删除空行
- 输出文件使用UTF-8编码，支持中文字符
- 如果列名不完全匹配，脚本会显示警告但继续处理

## 错误处理

脚本包含完善的错误处理机制：

- 文件不存在检查
- 文件格式验证
- 数据读取异常处理
- 列名匹配验证

## 示例输出

```
Excel转JSON工具
==================================================
正在读取Excel文件: 副本常用字词拼音-终稿.xlsx
检测到的列名: ['单字拼音', '汉字', '词', '词拼音']
成功转换 1252 行数据
JSON文件已保存到: 副本常用字词拼音-终稿.json

数据预览 (显示前10行):
------------------------------------------------------------
第1行:
  单字拼音: á
  汉字: 啊
  词: 啊呀
  词拼音: á yā

转换完成!
总行数: 1252
输出文件: 副本常用字词拼音-终稿.json
唯一汉字数量: 1215
唯一词汇数量: 1204
唯一单字拼音数量: 1252
汉字示例: ['哄', '烘', '仄', '涮', '解', '拯', '抓', '点', '葛', '牤']
拼音示例: ['bā', 'juě', 'dàng', 'fà', 'cǎo', 'rēng', 'dèng', 'zàn', 'jù', 'zuǎn']
```

## 转换结果

脚本成功将您的Excel文件转换为JSON格式：

- **总行数**: 1252行
- **唯一汉字数量**: 1215个
- **唯一词汇数量**: 1204个
- **唯一单字拼音数量**: 1252个
- **输出文件**: 副本常用字词拼音-终稿.json
